From f77c0a36bf132637eebe0b2cc70d251516a16705 Mon Sep 17 00:00:00 2001
From: GarethBouwer <itservices@bouwerandco.com>
Date: Wed, 4 Feb 2026 10:14:19 +0200
Subject: [PATCH 12/33] Detestfile

---
 Dockerfile | 18 +++++++++++++++---
 1 file changed, 15 insertions(+), 3 deletions(-)

diff --git a/Dockerfile b/Dockerfile
index a46c882fba3..e23139c90ed 100644
--- a/Dockerfile
+++ b/Dockerfile
@@ -1,6 +1,9 @@
 FROM php:8.1-apache
 
-# Install Moodle PHP dependencies
+# Enable Apache rewrite for clean URLs (recommended by Moodle)
+RUN a2enmod rewrite
+
+# Install system deps needed for Moodle + PostgreSQL extensions
 RUN apt-get update && apt-get install -y \
     git \
     unzip \
@@ -15,7 +18,16 @@ RUN apt-get update && apt-get install -y \
     libpq-dev \
     libldap2-dev \
  && docker-php-ext-configure gd --with-freetype --with-jpeg \
- && docker-php-ext-install gd intl xml zip mbstring curl pdo_pgsql opcache \
+ && docker-php-ext-install \
+        gd \
+        intl \
+        xml \
+        zip \
+        mbstring \
+        curl \
+        pgsql \
+        pdo_pgsql \
+        opcache \
  && rm -rf /var/lib/apt/lists/*
 
 # Web root
@@ -24,7 +36,7 @@ WORKDIR /var/www/html
 # Copy Moodle source
 COPY . /var/www/html
 
-# Moodle data directory (your Railway volume mounts here)
+# Moodle data directory (Railway volume mounts here)
 RUN mkdir -p /var/www/moodledata \
  && chown -R www-data:www-data /var/www/html /var/www/moodledata
 
-- 
2.48.1.windows.1

